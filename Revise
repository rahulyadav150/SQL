Q) There are 2 tables,first table has 5 records and second table has 10 records. you can assume any values in each of table.
how many maximum and minimum records possible in case of inner join,left join,right join and full outer join.
-----------------------------------------------------

Q) Problem with running sum
create table t (x int);

delete from t;

insert into t values(1),(2),(3),(1);

select x, sum(x) over (order by x) from t;
output - 
x sum(x)
1	2
1	2
2	4
3	7
if there are duplicates in order by then it consider both
 so we can resolve this in two ways
 select x, sum(x) over (order by x) from t;  adding one more column in order by so it become unique
 
 select x,sum(x) over(order by x rows between unbounded preceding and current row)   // 
 output-
x sum 
1	1
1	2
2	4
3	7


-----------------------------------------------------
Q) Count number of character and words in string.
create table strings (name varchar(50));
delete from strings;
insert into strings values ('Ankit Bansal'),('Ram Kumar Verma'),('Akshay Kumar Ak k'),('Rahul');
create table strings (name varchar(50));
delete from strings;
insert into strings values ('Ankit Bansal'),('Ram Kumar Verma'),('Akshay Kumar Ak k'),('Rahul');
---- count characters -------
select name,length(name) - length(replace(name,' ','')) cnt from strings;


-------count words words
>select name,(length(name) - length(replace(name,'wr','')))/length(wr) as cnt from strings;


---------------------------------------------------------------

Q) group by with window function
Ans-
with cte as (SELECT a.artist_name, 
dense_rank() over(order by count(r.rank) desc) as artist_rank
 FROM global_song_rank r LEFT JOIN songs s on r.song_id = s.song_id LEFT JOIN artists a on s.artist_id = a.artist_id where r.rank <= 10 
GROUP BY a.artist_name) 
SELECT * FROM cte WHERE artist_rank <= 5;

-------------------------------------------

Q) how to delete duplicates?

-----first approach -----------
create a backup table
delete all from original table
>insert into originaltable
select distinct * from backup table

distinct gives bad performance
>insert into original table
select col1,col2,coln from(
select col,col2,coln,row_number(partiton by col1 order by col2) rn from backup table
) where rn = 2;


---approch 2------

delete t1 from tablename t1 inner join (select col1,min(column which is differenct) form tablename group by col1 having count(1)>1) t2
on t1.col1 = t2.col1 // if table has multiple duplicates then run each time.

delete t1 from tablename t1 inner join (select col1,min(column which is differenct) form tablename  group by col1 having count(1)>1) t2
on t1.col1 = t2.col2 where t2.col is null; // run only one,delete all rows.

--approch 3 -----------

delete t1 from tablename t1 inner join (select *,row_number() over(partition by colname order by colname) rn from tableanme) t2
on t1.col = t2.col where rn >1
-----------------------------------------------

Q) create insert statement of a table containing data
>create table testing( `name` varchar(50),age int);
>delete from testing;
>insert into testing values('rahul',23),('rahul',25),('rahul',26);
>select concat('insert into testing values(',"'",name,"',",age,');') from testing;

